---
name: Extend Configuration Data Model for Thinking Tokens
status: open
created: 2025-09-24T00:23:41Z
updated: 2025-09-24T00:33:22Z
github: https://github.com/Linuxdazhao/cc_auto_switch/issues/13
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Extend Configuration Data Model for Thinking Tokens

## Description

Extend the Configuration struct and AddCommandParams in `src/cmd/types.rs` to support storing thinking token configuration. Add the `max_thinking_tokens` field following existing patterns for optional model configuration to maintain backward compatibility.

## Acceptance Criteria

- [ ] Configuration struct has `max_thinking_tokens: Option<u32>` field
- [ ] Field uses `#[serde(skip_serializing_if = "Option::is_none")]` attribute
- [ ] AddCommandParams struct includes `max_thinking_tokens: Option<u32>` field
- [ ] Existing configurations.json files continue to deserialize correctly
- [ ] New configurations serialize properly with or without thinking tokens
- [ ] Field follows naming conventions consistent with `small_fast_model`

## Technical Details

**Implementation Approach:**
- Add field to Configuration struct around line 25 in `src/cmd/types.rs`
- Follow exact pattern used by `model` and `small_fast_model` fields
- Add matching field to AddCommandParams struct around line 106
- Use u32 type for token count validation (1024-32000 range)

**Code Locations:**
- `src/cmd/types.rs`: Configuration struct (lines 12-26)
- `src/cmd/types.rs`: AddCommandParams struct (lines 100-111)

**Key Considerations:**
- Maintain exact serialization pattern for backward compatibility
- Use Option<u32> to handle both presence/absence and numeric values
- Follow existing field ordering and naming conventions

## Dependencies

- [ ] No external dependencies (uses existing serde patterns)

## Effort Estimate

- **Size**: XS
- **Hours**: 1-2 hours
- **Parallel**: true (no conflicts with other initial tasks)

## Definition of Done

- [ ] Code implemented following existing patterns exactly
- [ ] Configuration struct compiles without errors
- [ ] Serde serialization/deserialization works correctly
- [ ] Field can be set to None, 0, or valid token counts
- [ ] No breaking changes to existing configuration files
