---
github: https://github.com/Linuxdazhao/cc_auto_switch/issues/10
epic: quick-switch-with-number
priority: high
complexity: medium
created: 2025-09-07T11:58:17Z
updated: 2025-09-07T11:58:17Z
---

# Issue #10: fix-select-failed

## 问题描述

交互式选择功能发生 panic 错误：

```
thread 'main' panicked at /Users/jz/.cargo/registry/src/rsproxy.cn-e3de039b2554c837/cc-switch-0.0.17/src/cmd/interactive.rs:291:38:
byte index 12 is out of bounds of `123456`
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

## 根本原因分析

- **错误位置**: `src/cmd/interactive.rs:291:38`
- **错误类型**: 字符串索引越界
- **触发条件**: 输入字符串 `123456` 时尝试访问索引 12
- **影响范围**: 交互式菜单功能完全无法使用

## 技术细节

错误表明在处理用户输入时，代码尝试访问字符串 `123456` 的字节索引 12，但该字符串只有 6 个字符（字节索引 0-5）。这可能是：

1. **输入验证缺失**: 没有正确验证输入长度
2. **索引计算错误**: 计算字符串索引时出现数学错误
3. **边界条件处理**: 未正确处理超出范围的用户输入

## 解决方案

需要修复 `src/cmd/interactive.rs:291` 行的字符串处理逻辑：

1. **添加边界检查**: 确保索引不超出字符串长度
2. **改进输入验证**: 验证用户输入的有效性
3. **错误处理**: 优雅处理无效输入而不是 panic
4. **单元测试**: 添加边界条件测试用例

## 验收标准

- [ ] 修复 panic 错误，程序不会因无效输入崩溃
- [ ] 添加适当的输入验证和错误处理
- [ ] 添加边界条件单元测试
- [ ] 确保交互式菜单功能正常工作
- [ ] 在各种输入情况下测试稳定性

## 影响评估

- **优先级**: 高（程序 panic 是严重问题）
- **复杂性**: 中等（需要仔细分析输入处理逻辑）
- **测试范围**: 交互式功能的所有输入场景