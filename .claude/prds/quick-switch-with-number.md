---
name: quick-switch-with-number
description: 为 cc-switch current 命令的交互菜单添加数字键快速选择功能
status: backlog
created: 2025-09-06T12:01:58Z
---

# PRD: quick-switch-with-number

## Executive Summary

为 cc-switch 工具的 `current` 命令交互菜单增加数字键快速选择功能，允许用户通过按下数字键 1-9 直接选择对应的配置项并立即执行切换，提升用户操作效率。该功能将与现有的方向键导航功能并存，为高级终端用户提供更快速的操作方式。

## Problem Statement

### 当前痛点
目前 `cc-switch current` 命令的交互菜单只支持方向键导航选择，用户需要：
1. 使用上下方向键移动到目标配置
2. 按回车键确认选择
3. 对于配置较多的情况，导航过程较为繁琐

### 为什么现在需要解决
- **效率问题**：对于熟悉配置顺序的用户，数字键直选比方向键导航更快
- **用户体验**：现代CLI工具普遍支持数字快捷键，用户期望此功能
- **生产力提升**：开发者频繁切换API配置时，快速选择能显著提升工作效率

## User Stories

### 主要用户画像
- **CLI高级用户**：熟悉终端操作，追求操作效率
- **多配置管理者**：需要频繁在不同API配置间切换
- **开发者**：在不同项目或环境间切换Claude API配置

### 详细用户旅程

#### 用户故事 1：快速数字选择
**作为** 一个频繁使用cc-switch的开发者  
**我希望** 能通过按数字键直接选择配置  
**以便** 快速完成配置切换而无需方向键导航  

**验收标准：**
- 按数字键1-9立即选择对应位置的配置
- 选择后立即执行切换和Claude CLI启动
- 不需要额外按回车键确认

#### 用户故事 2：保持现有导航方式
**作为** 习惯方向键导航的用户  
**我希望** 数字键功能不影响现有的方向键操作  
**以便** 继续使用熟悉的操作方式  

**验收标准：**
- 方向键导航功能完全保留
- 数字键和方向键功能可以混合使用
- 界面显示保持一致

#### 用户故事 3：多页配置处理
**作为** 拥有大量配置的用户  
**我希望** 在配置超过9个时能正确处理分页  
**以便** 访问所有配置而不受数字键限制  

**验收标准：**
- 每页最多显示9个配置（数字键1-9对应）
- 提供页面导航机制（如PageUp/PageDown）
- 页面信息清晰显示（当前页/总页数）

### 痛点场景
1. **配置切换频繁**：开发过程中需要在个人配置和团队配置间快速切换
2. **配置列表较长**：当存储了多个API配置时，方向键导航耗时
3. **肌肉记忆**：用户已熟悉配置顺序，希望直接按数字选择

## Requirements

### Functional Requirements

#### 核心功能
1. **数字键直选**
   - 支持数字键1-9选择对应位置的配置项
   - 按下数字键后立即执行选择，无需确认
   - 仅在crossterm全功能终端模式下启用

2. **分页处理**
   - 配置超过9个时自动分页
   - 每页显示最多9个配置项
   - 提供页面导航键（如PageUp/PageDown或n/p）
   - 显示页面信息："第 X 页，共 Y 页"

3. **双模式兼容**
   - 保持现有方向键导航功能完整
   - 数字键和方向键可以混合使用
   - 简单菜单模式（终端功能受限）不受影响

#### 用户界面
1. **菜单显示增强**
   - 每个配置项前显示对应数字（1-9）
   - 格式：`[1] 配置名称 - 详细信息`
   - 当前选中项高亮显示保持不变

2. **操作提示**
   - 在菜单底部显示操作说明
   - 例如：`方向键导航，数字键直选，回车确认`
   - 分页时添加翻页提示

3. **实时反馈**
   - 数字键按下后立即执行，无加载延迟
   - 保持现有的配置切换反馈信息

### Non-Functional Requirements

#### 性能期望
- **响应时间**：数字键按下到配置切换完成 < 200ms
- **内存占用**：新功能不增加显著内存开销
- **CPU使用**：键盘事件处理不影响终端响应性

#### 兼容性
- **终端兼容**：仅在支持crossterm全功能的终端中启用
- **平台支持**：Windows、macOS、Linux全平台支持
- **Rust版本**：兼容项目当前使用的Rust版本

#### 可用性
- **学习成本**：现有用户无需学习成本，新功能直观易用
- **错误处理**：无效按键（如数字0或超出范围）给出清晰提示
- **降级处理**：简单菜单模式下优雅降级

## Success Criteria

### 可衡量结果
1. **使用率指标**
   - 50%以上的current命令使用采用数字键选择
   - 配置切换平均时间减少30%

2. **用户体验指标**
   - 数字键选择成功率 > 95%
   - 无用户反馈的功能冲突或错误

3. **技术指标**
   - 新功能代码覆盖率 > 90%
   - 所有现有测试保持通过
   - 无性能回归

### 关键指标和KPI
- **功能完整性**：支持1-9数字键直选，分页正常工作
- **兼容性**：现有功能100%保持不变
- **稳定性**：连续操作1000次无崩溃或异常

## Constraints & Assumptions

### 技术限制
1. **终端能力依赖**：功能依赖crossterm库的事件捕获能力
2. **单页配置限制**：每页最多9个配置，由数字键1-9限制
3. **同步执行**：数字键选择后的配置切换必须同步完成

### 时间约束
- **开发周期**：预计2-3个工作日完成开发
- **测试周期**：1个工作日进行全面测试
- **发布窗口**：与下个版本一同发布

### 资源限制
- **人力资源**：单人开发，无需额外资源
- **测试资源**：需要多平台测试环境
- **依赖库**：避免引入新的外部依赖

### 假设条件
1. 用户主要在支持crossterm全功能的现代终端中使用
2. 大部分用户的配置数量在合理范围内（<50个）
3. 用户能接受分页机制来处理大量配置

## Out of Scope

### 明确不构建的功能
1. **字母快捷键**：不支持a-z字母键快速选择
2. **自定义快捷键**：不支持用户自定义数字键映射
3. **配置搜索**：不添加配置名称搜索功能
4. **批量操作**：不支持多选或批量配置切换
5. **简单菜单模式增强**：简单菜单模式保持现状，不添加任何新功能
6. **历史记录**：不记录用户的选择历史或偏好

### 未来可能考虑的功能
- 配置收藏/置顶功能
- 键盘自定义映射
- 配置分组显示

## Dependencies

### 外部依赖
1. **crossterm库**：依赖当前版本的crossterm进行键盘事件处理
2. **现有interactive模块**：基于src/cmd/interactive.rs进行扩展

### 内部团队依赖
- **无额外依赖**：单人开发项目，无跨团队协作需求
- **测试环境**：需要多平台测试，但可通过CI/CD自动化完成

### 技术栈依赖
- Rust 1.88.0+
- crossterm 库（现有版本）
- 现有的配置管理和终端UI架构

### 发布依赖
- 与主版本一同发布
- 需要更新用户文档和帮助信息
- CI/CD管道需要包含新功能的测试用例